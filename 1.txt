.版本 2
.DLL命令 SetWindowsHookEx, 整数型, "user32.dll", "SetWindowsHookExA"
.参数 idHook, 整数型  ; 钩子类型（13=键盘钩子）
.参数 lpfn, 子程序指针
.参数 hmod, 整数型
.参数 dwThreadId, 整数型

.DLL命令 UnhookWindowsHookEx, 逻辑型, "user32.dll", "UnhookWindowsHookEx"
.参数 hhk, 整数型

.变量 全局钩子句柄, 整数型

.子程序 _启动窗口_创建完毕
全局钩子句柄 ＝ SetWindowsHookEx(13, &键盘钩子回调, GetModuleHandle(0), 0)  ; 

.子程序 键盘钩子回调, 整数型
.参数 nCode, 整数型
.参数 wParam, 整数型  ; 状态（256=按下，257=弹起）
.参数 lParam, 整数型  ; 键代码指针
.如果真 (nCode ≥ 0)
    .如果真 (wParam ＝ 256)  ; 按下事件
        .局部变量 键代码, 整数型
        键代码 ＝ 取字节集数据(指针到字节集(lParam, 1), 3, )  ; 解析键代码
        .如果真 (键代码 ＝ #空格键)  ; 
            输出调试文本 (“检测到全局空格键按下”)
        .如果真结束
    .如果真结束
返回 CallNextHookEx(全局钩子句柄, nCode, wParam, lParam)

.子程序 _按钮_销毁_被单击  ; 窗口关闭时卸载钩子
UnhookWindowsHookEx(全局钩子句柄)